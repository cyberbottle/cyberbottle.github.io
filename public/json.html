<!DOCTYPE html>
<html lang="en">
<head>
    <title>Animate a line</title>
    <meta property="og:description" content="Animate a line by updating a GeoJSON source on each frame." />
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel='stylesheet' href='https://unpkg.com/maplibre-gl@4.7.0/dist/maplibre-gl.css' />
    <script src='https://unpkg.com/maplibre-gl@4.7.0/dist/maplibre-gl.js'></script>
    <style>
        body { margin: 0; padding: 0; }
        html, body, #map { height: 100%; }
    </style>
</head>
<body>
<style>
    button {
        position: absolute;
        top: 0;
        margin: 20px;
    }

    #pause::after {
        content: 'Pause';
    }

    #pause.pause::after {
        content: 'Play';
    }
</style>
<div id="map"></div>
<button id="pause"></button>
<script>
    const map = new maplibregl.Map({
        container: 'map',
        style:
            'https://api.maptiler.com/maps/streets/style.json?key=qi2lqLtmvCDiZ8epFXyx',
        center: [0, 0],
        zoom: 0.5
    });

    // Create a GeoJSON source with an empty lineString.
    const geojson = {"type":"FeatureCollection","metadata":{"name":"перспектива","creator":"Yandex Map Constructor"},"features":[{"type":"Feature","id":0,"geometry":{"type":"Polygon","coordinates":[[[44.55022085925713,48.74746056561079],[44.549952638355535,48.746194074231894],[44.55217350741986,48.74576480796411],[44.55259997865319,48.74659318214811],[44.55279041549315,48.74759182484938],[44.55212522765747,48.7476627756214],[44.55194551965344,48.747199820083026],[44.55022085925713,48.74746056561079]]]},"properties":{"description":"8 мая 1961 \nдепо 4","fill":"#177bc9","fill-opacity":0.3,"stroke":"#ed4543","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":1,"geometry":{"type":"Polygon","coordinates":[[[44.50210635877887,48.69471427232665],[44.50311486936847,48.69403952192695],[44.50500314451496,48.69522565604381],[44.50518553472793,48.69561629287211],[44.50442378736775,48.69619158880959],[44.50210635877887,48.69471427232665]]]},"properties":{"fill":"#177bc9","fill-opacity":0.6,"stroke":"#ed4543","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":2,"geometry":{"type":"LineString","coordinates":[[44.52335865745498,48.71104153464066],[44.525859916995536,48.712648932656066],[44.53735978851275,48.725623364812755],[44.53831230286847,48.728106195306374],[44.54723140636949,48.73994166694139],[44.54763566140417,48.74060394361697],[44.54979202689438,48.751842946650676],[44.55092520584995,48.753116378707325],[44.54946608414585,48.753676825007105],[44.54932660927707,48.75335048995174],[44.54934002032203,48.75148289020436],[44.549468766354735,48.7513019794021],[44.54967529644888,48.75124344929358]]},"properties":{"description":"31 декабря 1960","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":3,"geometry":{"type":"LineString","coordinates":[[44.54871077558179,48.74611846863128],[44.54945911189695,48.746067027747856],[44.54973269721645,48.7461007304016],[44.549915087429476,48.7462071596852],[44.55049176236767,48.74618942149569],[44.55206085464138,48.745880775847745],[44.552447092739484,48.746588529449085],[44.552447092739484,48.74693974179547],[44.55056954642908,48.747266118732426],[44.55045689365045,48.74719516740578],[44.55005992671624,48.74620183825247]]},"properties":{"description":"8 мая 1961 ","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":4,"geometry":{"type":"LineString","coordinates":[[44.55091286918262,48.753173133161425],[44.56147004386518,48.764990819861765]]},"properties":{"description":"1961","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":5,"geometry":{"type":"LineString","coordinates":[[44.561502230373286,48.76501919034611],[44.566708866473945,48.77087787092513],[44.57521006953994,48.777082746847306],[44.59547853337295,48.79013273403716],[44.59727800261653,48.792405625316775],[44.59778225791136,48.79259702024382],[44.59791636836208,48.7926874009389],[44.59794050824325,48.792804363928646],[44.59787345301784,48.79288942776369],[44.59766960513271,48.79295676985678],[44.59727532040751,48.79240562533387]]},"properties":{"description":"1962","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":6,"geometry":{"type":"LineString","coordinates":[[44.5976998959341,48.79297551495461],[44.60407846961701,48.80133947631022],[44.60448750649133,48.80139086044937],[44.604696718794514,48.80166726976222],[44.604353396040594,48.801762949552],[44.6040851751391,48.801366054419]]},"properties":{"description":"1964","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":7,"geometry":{"type":"LineString","coordinates":[[44.523343439247924,48.7110357237853],[44.51145598189057,48.703653461189525],[44.50559979718703,48.70057139370732],[44.501006002571835,48.69779196467034],[44.50141369834202,48.69750077563434],[44.50198232665328,48.69789139467901],[44.501681919243644,48.69819678563164]]},"properties":{"description":"30 апреля 1964","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":8,"geometry":{"type":"LineString","coordinates":[[44.50082989688874,48.697772554810854],[44.478084764442414,48.68402089599692],[44.47795601840968,48.68106550099709],[44.47642587475698,48.67894878815651],[44.47621794696803,48.678813316083385],[44.47599800582874,48.67882752578279],[44.47489830013262,48.67918631902528],[44.47345258947359,48.67750067898519],[44.473997077903576,48.67729108016209],[44.474246523342,48.67758949178498],[44.47384419198975,48.6779553988679]]},"properties":{"description":"1965","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":9,"geometry":{"type":"LineString","coordinates":[[44.60442163353774,48.80185988002715],[44.60656740074965,48.804538834396695],[44.60910868861394,48.80701944058595],[44.611608507415816,48.808975314294266],[44.61449456431585,48.80805407898204],[44.615824939987185,48.80682101433863],[44.61871408394548,48.80586399688153],[44.61952411106797,48.80557414416382],[44.61935781410905,48.80536862528374],[44.619084228789525,48.80551744938497],[44.61919688156816,48.805691076941606]]},"properties":{"description":"1965","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":10,"geometry":{"type":"LineString","coordinates":[[44.54584895235771,48.770759655273885],[44.56574021441216,48.785522579709294],[44.58058892351859,48.79017320157408],[44.59483681780571,48.79958654799457],[44.59706841570609,48.8005504651125],[44.603677378718785,48.80205300464576],[44.60436402422657,48.8018687333833]]},"properties":{"description":"1969","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":11,"geometry":{"type":"LineString","coordinates":[[44.51602412921564,48.71234545025864],[44.519006745640176,48.713737047694266],[44.5232553647198,48.71103901744153]]},"properties":{"description":"19 марта 1969","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":12,"geometry":{"type":"LineString","coordinates":[[44.51599194270735,48.71239519176441],[44.51521410209304,48.71295964482639],[44.51491905910139,48.712984494814805],[44.51478494865065,48.712881544782405],[44.51483859283094,48.71274664441922],[44.51557351810104,48.71245909243077],[44.516002671543404,48.712349041232386]]},"properties":{"stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":13,"geometry":{"type":"LineString","coordinates":[[44.4972364493711,48.69546572081147],[44.49927492822243,48.69391735594366],[44.50386687005592,48.69658790027278],[44.50487538064547,48.69593448239822]]},"properties":{"description":"1971","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":14,"geometry":{"type":"LineString","coordinates":[[44.52034538008012,48.70920145459611],[44.50339381910602,48.721384483522655],[44.4904435816286,48.74195792749087]]},"properties":{"description":"3 ноября 1977","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":15,"geometry":{"type":"LineString","coordinates":[[44.490471873306916,48.74192266383337],[44.482575449967,48.75379976601603]]},"properties":{"description":"2 февраля 1978","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":16,"geometry":{"type":"LineString","coordinates":[[44.611613055080376,48.80895593486067],[44.6141718824806,48.81063537451798],[44.617374440044344,48.812343101111935],[44.62625536391517,48.8165471047078],[44.62711696627385,48.816493058903525],[44.627784836318575,48.81680126811708],[44.62748174669988,48.81707582069642],[44.62625597718003,48.81654796988844]]},"properties":{"description":"6 нояб. 1979","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":17,"geometry":{"type":"LineString","coordinates":[[44.627606017362645,48.817130859128035],[44.64099560476495,48.82357797455865],[44.64169297910882,48.82318833742823],[44.6423742601986,48.82369486511465],[44.642063123952866,48.8238578029961],[44.64137111402703,48.82339024069812]]},"properties":{"description":"1 октября 1980","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":18,"geometry":{"type":"LineString","coordinates":[[44.50847140590849,48.70614854108655],[44.511432564660915,48.7036773441714]]},"properties":{"description":"1 мая 1989","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":19,"geometry":{"type":"LineString","coordinates":[[44.495090001003966,48.73465718254465],[44.502535813229365,48.7380777800218],[44.50530385293274,48.74091627240743],[44.50088357247619,48.747231339456995],[44.49636361982683,48.751687721057564],[44.49500261360023,48.75342069286533],[44.4944500785431,48.75325752480212],[44.49476657920684,48.75286024373501],[44.49529229217379,48.75302696027685]]},"properties":{"description":"9 февраля 1991","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":20,"geometry":{"type":"LineString","coordinates":[[44.49615129126869,48.752054690019875],[44.504718266862135,48.75462636108865],[44.50481214417762,48.75441708523116],[44.50438299073528,48.75429293810786],[44.503932379620785,48.75438338817903]]},"properties":{"description":"28 декабря 1991","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":21,"geometry":{"type":"LineString","coordinates":[[44.504778642441146,48.75467503135275],[44.51089407899511,48.75644851871156],[44.51168801286352,48.755299306085085],[44.51567913987768,48.75644851871156],[44.51709534623754,48.75664714537425],[44.52213789918549,48.758104899045655],[44.520432014251796,48.760619512810926],[44.51985986714753,48.76042451039378],[44.520444588712735,48.75954848526454],[44.52104540353208,48.759679712680786]]},"properties":{"description":"19 декабря 1992","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":22,"geometry":{"type":"LineString","coordinates":[[44.482593244930065,48.75385401905393],[44.478516287227464,48.75950067666164],[44.478087133785095,48.76707584252426],[44.504308409114664,48.767983650476666],[44.50399727286896,48.77172109205218],[44.49712008895471,48.77144451678906],[44.49745268287253,48.767749607868],[44.49271053733416,48.76760067108102],[44.492635435481695,48.76816095485442],[44.47335571708266,48.76738790347303],[44.47848011122532,48.759529845633054]]},"properties":{"description":"1 сентября 2024","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":23,"geometry":{"type":"LineString","coordinates":[[44.49752025935123,48.76761919164363],[44.49769192072817,48.7643850269404],[44.49773483607238,48.76227135875878],[44.51271229121153,48.76630001820294],[44.515566161603374,48.765489443018645],[44.5168536219305,48.764581589738896],[44.51726668211874,48.764264191861365],[44.517550996274316,48.763748194318616],[44.519846967191064,48.762017524391815],[44.52183180186205,48.759751249104994],[44.52116661402627,48.75955972819564]]},"properties":{"description":"1 сентября 2024","stroke":"#177bc9","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":24,"geometry":{"type":"LineString","coordinates":[[44.54580002161908,48.77065457678258],[44.53442745539602,48.761831591148756],[44.52610187861379,48.747359654506724],[44.524556926221216,48.742307677687236],[44.52876262995653,48.738844791803345],[44.53090839716844,48.73629005003977],[44.530221751660626,48.734530040853976],[44.52738933894091,48.73254285922036],[44.45717983576707,48.689259491226366],[44.4455926928227,48.68045054753387],[44.42301922175325,48.61606984685346],[44.42104511591829,48.590396905119874],[44.42319088313012,48.57781180220938],[44.459068110913336,48.540550541084656],[44.47383098933124,48.53188647735638],[44.51090984675313,48.514896023838425],[44.534427455395715,48.51558031395925],[44.54472713801289,48.51329931073533],[44.56481151911641,48.51740504217305],[44.56699455207442,48.51592665052112]]},"properties":{"stroke":"#ed4543","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":25,"geometry":{"type":"LineString","coordinates":[[44.64108596749289,48.823617392627106],[44.641729697656466,48.82425497358754],[44.64254508919696,48.826691874556424],[44.64730869240735,48.83072950042389],[44.64818845696429,48.83115449462678],[44.64943300194721,48.83157948521221],[44.65127836174943,48.83173531418506],[44.653059348535336,48.83155115261932],[44.6917904467103,48.82010346672791],[44.702819690179496,48.818814020484176],[44.717561110925296,48.81878568064818],[44.720779761743174,48.818473941201994],[44.7357143015381,48.812635551367265],[44.73683530271959,48.81408440725758],[44.75392081195769,48.809014201306496],[44.74937011705191,48.80207664948775],[44.755055692179106,48.80027643252302],[44.756901646081516,48.79415402747996],[44.7637257799156,48.788824870199335],[44.751281518286895,48.78633270984287],[44.74664666110917,48.79750463356059],[44.724330682105204,48.816836922719304]]},"properties":{"stroke":"#ed4543","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":26,"geometry":{"type":"LineString","coordinates":[[44.52188591165941,48.75971896051106],[44.52298025293749,48.758016525343656],[44.523602525428906,48.75648428410694],[44.524460832313665,48.75397300925757],[44.5256919662513,48.75230939759868],[44.52678630752938,48.751330359234856],[44.526867450164524,48.750749348730665],[44.52545124380464,48.748237785543935],[44.525515616821004,48.74795398515247],[44.52583748190279,48.747769514033465],[44.52617007582063,48.7477766090891],[44.52637392370576,48.747875939762174]]},"properties":{"stroke":"#ed4543","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":27,"geometry":{"type":"LineString","coordinates":[[44.47804043695157,48.68393877406699],[44.47233269616792,48.68064235532188],[44.46533749505707,48.67907932232371],[44.45696900293001,48.66901790628753],[44.445267858129604,48.65640288072475],[44.439173879247775,48.6450287537062],[44.43971032105075,48.64309489546956],[44.4390022178708,48.63800394142651],[44.43629855118379,48.63291247054655],[44.429517926794155,48.63447694398559]]},"properties":{"stroke":"#ed4543","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":28,"geometry":{"type":"LineString","coordinates":[[44.76383079347671,48.7888299326682],[44.779924047566105,48.79180731748917],[44.78348602113787,48.78227906047544],[44.799150121784876,48.776010970762776],[44.82279414192293,48.75415886676017],[44.81382483497717,48.74959002605755],[44.79700202003578,48.758670541531494],[44.78798979774573,48.767635930615526],[44.768806638871226,48.77815969701612],[44.76331347480871,48.7887379586146]]},"properties":{"stroke":"#ed4543","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":29,"geometry":{"type":"LineString","coordinates":[[44.52870427233311,48.75188521179395],[44.52913879019357,48.75176460562216],[44.529610858980206,48.75128217805773],[44.52987371546365,48.751186401442844],[44.53294752699471,48.75066494777109],[44.53342496019936,48.75064011650768],[44.543821202341086,48.75140633269026],[44.54883403563244,48.752101507846454],[44.549960563418644,48.75205894119157]]},"properties":{"stroke":"#ed4543","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":30,"geometry":{"type":"LineString","coordinates":[[44.43394500105188,48.64635301566685],[44.43918067304895,48.6451586141581]]},"properties":{"stroke":"#ed4543","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":31,"geometry":{"type":"LineString","coordinates":[[44.56717604205317,48.515884543362304],[44.57524412676994,48.52110191832274],[44.565330682250845,48.527979189159],[44.55758446261584,48.526618062972105],[44.55717676684558,48.526432775942844],[44.55612534091175,48.52583415161949],[44.55524557635486,48.52506448131674],[44.55475204989612,48.524579868052875],[44.55453747317492,48.5236391348725],[44.55473059222399,48.522798161553915],[44.55767029330431,48.51598433436665]]},"properties":{"stroke":"#ed4543","stroke-width":"5","stroke-opacity":0.9}},{"type":"Feature","id":32,"geometry":{"type":"Point","coordinates":[44.51486934444213,48.71260327115184]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":33,"geometry":{"type":"Point","coordinates":[44.522840869633434,48.710373806817664]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":34,"geometry":{"type":"Point","coordinates":[44.52816237231976,48.71467644263013]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":35,"geometry":{"type":"Point","coordinates":[44.52998627444991,48.71655074277738]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":36,"geometry":{"type":"Point","coordinates":[44.53608025333174,48.723919469168706]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":37,"geometry":{"type":"Point","coordinates":[44.538172376363356,48.72746856456329]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":38,"geometry":{"type":"Point","coordinates":[44.544652593343216,48.73610600985631]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":39,"geometry":{"type":"Point","coordinates":[44.54715241214497,48.73957972991874]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":40,"geometry":{"type":"Point","coordinates":[44.54911578914372,48.74606525340409]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":41,"geometry":{"type":"Point","coordinates":[44.54993118068419,48.7512729308463]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":42,"geometry":{"type":"Point","coordinates":[44.5397280575914,48.72979308582215]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":43,"geometry":{"type":"Point","coordinates":[44.55484766981884,48.757342627433836]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":44,"geometry":{"type":"Point","coordinates":[44.55799121878412,48.76079004504955]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":45,"geometry":{"type":"Point","coordinates":[44.56107441804514,48.76473016722514]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":46,"geometry":{"type":"Point","coordinates":[44.56704761131246,48.77071578346704]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":47,"geometry":{"type":"Point","coordinates":[44.57492257698015,48.77714053790868]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":48,"geometry":{"type":"Point","coordinates":[44.583162323073886,48.78250095834876]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":49,"geometry":{"type":"Point","coordinates":[44.588097587661245,48.785251850011896]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":50,"geometry":{"type":"Point","coordinates":[44.59183122260999,48.78754887014949]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":51,"geometry":{"type":"Point","coordinates":[44.59792520149176,48.793021590702125]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":52,"geometry":{"type":"Point","coordinates":[44.5710414205352,48.77397613085579]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":53,"geometry":{"type":"Point","coordinates":[44.60177927747081,48.798114755933156]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":54,"geometry":{"type":"Point","coordinates":[44.51549862599918,48.70657201843716]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":55,"geometry":{"type":"Point","coordinates":[44.5184383270795,48.70837561582917]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":56,"geometry":{"type":"Point","coordinates":[44.51046680188681,48.70322738063922]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":57,"geometry":{"type":"Point","coordinates":[44.50493072248036,48.70034413716104]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":58,"geometry":{"type":"Point","coordinates":[44.50089668012196,48.697872653587446]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":59,"geometry":{"type":"Point","coordinates":[44.497897702512,48.695783096912805]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":60,"geometry":{"type":"Point","coordinates":[44.49357398157995,48.69311961250901]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":61,"geometry":{"type":"Point","coordinates":[44.488906937893624,48.69033523223154]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":62,"geometry":{"type":"Point","coordinates":[44.48498018389555,48.68797691122345]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":63,"geometry":{"type":"Point","coordinates":[44.47925098544028,48.68497912563781]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":64,"geometry":{"type":"Point","coordinates":[44.4741869748199,48.677746762867606]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":65,"geometry":{"type":"Point","coordinates":[44.61952425294167,48.80553450350897]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":66,"geometry":{"type":"Point","coordinates":[44.61440659814119,48.80817428489545]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":67,"geometry":{"type":"Point","coordinates":[44.60958935075035,48.80717153881148]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":68,"geometry":{"type":"Point","coordinates":[44.60557676606401,48.80320996296532]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":69,"geometry":{"type":"Point","coordinates":[44.54683600527515,48.77129862849965]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":70,"geometry":{"type":"Point","coordinates":[44.549861537043945,48.77363883927212]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":71,"geometry":{"type":"Point","coordinates":[44.55449639422168,48.77690076819412]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":72,"geometry":{"type":"Point","coordinates":[44.55780087572803,48.779510157842836]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":73,"geometry":{"type":"Point","coordinates":[44.561727629725794,48.78245973837376]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":74,"geometry":{"type":"Point","coordinates":[44.565374092881186,48.784717007058326]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":75,"geometry":{"type":"Point","coordinates":[44.57048370105448,48.787160272187236]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":76,"geometry":{"type":"Point","coordinates":[44.57462503177346,48.78852143000803]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":77,"geometry":{"type":"Point","coordinates":[44.58121253711399,48.79046385132935]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":78,"geometry":{"type":"Point","coordinates":[44.586426751438985,48.79378138874022]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":79,"geometry":{"type":"Point","coordinates":[44.5899887250107,48.796276485169564]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":80,"geometry":{"type":"Point","coordinates":[44.59801389438325,48.80064260358187]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":81,"geometry":{"type":"Point","coordinates":[44.60339977008514,48.80208844166092]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":82,"geometry":{"type":"Point","coordinates":[44.519647473382676,48.70988845037166]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":83,"geometry":{"type":"Point","coordinates":[44.51009612708049,48.71659258632409]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":84,"geometry":{"type":"Point","coordinates":[44.507702926086715,48.71831950584159]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":85,"geometry":{"type":"Point","coordinates":[44.505728820251754,48.71980322450447]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":86,"geometry":{"type":"Point","coordinates":[44.50312171308927,48.72198967703947]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":87,"geometry":{"type":"Point","coordinates":[44.501319268631256,48.72468711661153]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":88,"geometry":{"type":"Point","coordinates":[44.49976358740258,48.72724954942027]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":89,"geometry":{"type":"Point","coordinates":[44.497714379715205,48.730479021421985]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":90,"geometry":{"type":"Point","coordinates":[44.49546132414267,48.733992166119975]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":91,"geometry":{"type":"Point","coordinates":[44.494098761963095,48.736199288302]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":92,"geometry":{"type":"Point","coordinates":[44.49065480558794,48.741713119410235]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":93,"geometry":{"type":"Point","coordinates":[44.48815028030276,48.74557910923705]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":94,"geometry":{"type":"Point","coordinates":[44.485618274992696,48.749282753647115]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":95,"geometry":{"type":"Point","coordinates":[44.48353688079711,48.75240438625981]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":96,"geometry":{"type":"Point","coordinates":[44.6202567646618,48.813616475830266]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":97,"geometry":{"type":"Point","coordinates":[44.624376637708664,48.81550832187562]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":98,"geometry":{"type":"Point","coordinates":[44.626854998837324,48.81682619521117]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":99,"geometry":{"type":"Point","coordinates":[44.63256273962201,48.819546854067504]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":100,"geometry":{"type":"Point","coordinates":[44.64015339113415,48.82304665058452]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":101,"geometry":{"type":"Point","coordinates":[44.5087074403018,48.70610593529689]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":102,"geometry":{"type":"Point","coordinates":[44.51114020387809,48.70393387865048]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":103,"geometry":{"type":"Point","coordinates":[44.498264871972665,48.73603285853194]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":104,"geometry":{"type":"Point","coordinates":[44.50283535613403,48.738303758243504]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":105,"geometry":{"type":"Point","coordinates":[44.50386532439568,48.74310069466337]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":106,"geometry":{"type":"Point","coordinates":[44.50037845267624,48.74778364987658]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":107,"geometry":{"type":"Point","coordinates":[44.497867905038305,48.75043712965906]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":108,"geometry":{"type":"Point","coordinates":[44.49943568208357,48.75315535851296]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":109,"geometry":{"type":"Point","coordinates":[44.50404908158918,48.7545741966144]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":110,"geometry":{"type":"Point","coordinates":[44.50992701510315,48.75637521249695]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":111,"geometry":{"type":"Point","coordinates":[44.51868174532778,48.75704202844069]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":112,"geometry":{"type":"Point","coordinates":[44.51994774798277,48.76020573591635]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":113,"geometry":{"type":"Point","coordinates":[44.47958045344011,48.75837036529545]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":114,"geometry":{"type":"Point","coordinates":[44.478700688883215,48.76177515347919]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":115,"geometry":{"type":"Point","coordinates":[44.47844319681779,48.7646122996381]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":116,"geometry":{"type":"Point","coordinates":[44.47333627085343,48.76688190051611]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":117,"geometry":{"type":"Point","coordinates":[44.478636315866744,48.766988285593676]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":118,"geometry":{"type":"Point","coordinates":[44.484408429666786,48.76718687034502]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":119,"geometry":{"type":"Point","coordinates":[44.49232631067894,48.76747765358361]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":120,"geometry":{"type":"Point","coordinates":[44.50015836100244,48.76777552749894]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":121,"geometry":{"type":"Point","coordinates":[44.50447135309839,48.76811595266931]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":122,"geometry":{"type":"Point","coordinates":[44.50423531870507,48.77004498460075]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":123,"geometry":{"type":"Point","coordinates":[44.50176768641138,48.77177537629194]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":124,"geometry":{"type":"Point","coordinates":[44.49745469431543,48.76854857298168]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":125,"geometry":{"type":"Point","coordinates":[44.47494023184429,48.764651309437966]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":126,"geometry":{"type":"Point","coordinates":[44.47719328741675,48.76107648169298]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":127,"geometry":{"type":"Point","coordinates":[44.52021218359572,48.76193161976642]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":128,"geometry":{"type":"Point","coordinates":[44.49791766226381,48.76241394455155]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":129,"geometry":{"type":"Point","coordinates":[44.5040545564898,48.76388926183795]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":130,"geometry":{"type":"Point","coordinates":[44.50738049566825,48.76485386878334]},"properties":{"marker-color":"#1e98ff"}},{"type":"Feature","id":131,"geometry":{"type":"Point","coordinates":[44.51227284491143,48.76631492910191]},"properties":{"marker-color":"#1e98ff"}}]}

    const speedFactor = 30; // number of frames per longitude degree
    let animation; // to store and cancel the animation
    let startTime = 0;
    let progress = 0; // progress = timestamp - startTime
    let resetTime = false; // indicator of whether time reset is needed for the animation
    const pauseButton = document.getElementById('pause');

    map.on('load', () => {
        map.addSource('line', {
            'type': 'geojson',
            'data': geojson
        });

        // add the line which will be modified in the animation
        map.addLayer({
            'id': 'line-animation',
            'type': 'line',
            'source': 'line',
            'layout': {
                'line-cap': 'round',
                'line-join': 'round'
            },
            'paint': {
                'line-color': '#ed6498',
                'line-width': 5,
                'line-opacity': 0.8
            }
        });

        startTime = performance.now();

        animateLine();

        // click the button to pause or play
        pauseButton.addEventListener('click', () => {
            pauseButton.classList.toggle('pause');
            if (pauseButton.classList.contains('pause')) {
                cancelAnimationFrame(animation);
            } else {
                resetTime = true;
                animateLine();
            }
        });

        // reset startTime and progress once the tab loses or gains focus
        // requestAnimationFrame also pauses on hidden tabs by default
        document.addEventListener('visibilitychange', () => {
            resetTime = true;
        });

        // animated in a circle as a sine wave along the map.
        function animateLine(timestamp) {
            if (resetTime) {
                // resume previous progress
                startTime = performance.now() - progress;
                resetTime = false;
            } else {
                progress = timestamp - startTime;
            }

            // restart if it finishes a loop
            if (progress > speedFactor * 360) {
                startTime = timestamp;
                geojson.features[0].geometry.coordinates = [];
            } else {
                const x = progress / speedFactor;
                // draw a sine wave with some math.
                const y = Math.sin((x * Math.PI) / 90) * 40;
                // append new coordinates to the lineString
                geojson.features[0].geometry.coordinates.push([x, y]);
                // then update the map
                map.getSource('line').setData(geojson);
            }
            // Request the next frame of the animation.
            animation = requestAnimationFrame(animateLine);
        }
    });
</script>
</body>
</html>